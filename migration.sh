#!/system/bin/sh

# Official microg keys
media_cert_official='308203b33082029ba003020102020900e1c286d5b6096213300d06092a864886f70d01010505003070310b30090603550406130255533113301106035504080c0a57617368696e67746f6e3110300e06035504070c0753656174746c6531123010060355040a0c094c696e656167654f5331123010060355040b0c094c696e656167654f533112301006035504030c094c696e656167654f53301e170d3137303130373034323132385a170d3434303532353034323132385a3070310b30090603550406130255533113301106035504080c0a57617368696e67746f6e3110300e06035504070c0753656174746c6531123010060355040a0c094c696e656167654f5331123010060355040b0c094c696e656167654f533112301006035504030c094c696e656167654f5330820122300d06092a864886f70d01010105000382010f003082010a0282010100cc818ef9a14c1ae3b79fb0805f59aff780e9a8b28bddf9c71703af8ffc15dc30a8439a6ebbfea3b2ca429cd07b1feb6a3b33446688964cf70f23e9637d91ef0a5654c2d4261487fdb9bb0b01abfd52f5edc2aec205a7849b0f66ac25d9e434a43e8a5cc75f11df6847c5f7d9fdad45ef0f6bf53f8c7bb73319e6a28bfee7e06e97d5d2b7d53c8cf2d2638ede5404dfd27cc39c7631c9a52eb632f79cb108b50d0e136bd639d19b4f05e5c840680a0241b86fd702c2c44b2f196e306eac2dc40066f1ea1e43496b1ba4c85fedfd68374064f139a5630dde0c84a0e9dbb7f953562fe400ff02bcc6aadfda63fd572e473da83e22bf21c1421fefb3c3707d5a97630203010001a350304e301d0603551d0e04160414fbc481032a0bed6d36b8d11d46e0ef18ebfc06b2301f0603551d23041830168014fbc481032a0bed6d36b8d11d46e0ef18ebfc06b2300c0603551d13040530030101ff300d06092a864886f70d010105050003820101007dd63789ed7427ca371673242b6c5f7fb669bcb6f681ad833e413bcba56be119df42ae035681d806a7c6fb8db17a09120b7dcde5b28752466e6afaf57339f6d9d6ef74f687535021e7c33c0c8c99bd10bcd587c2856b8ba1318ea9616aee74b6d60efd15a59014c190b9c8bb79ad942db520ff0c2fd7ebef7f68424ab9a375f7768a24a8c0f954de6c31c3880d87ec8e518daf51466a78c3182e8fcfe5774e217309b27e6110f84f0bbe89d15d21d77c4c269e14e9d88619145fdf43aa17b54388006cb8bf648001951bc5a1f2b308f6f5b1c929fa522406a84b253c3032187fa5480aaf3de4eba86b2bc43371b5eb2bf26f1ce17ab4413a5793087e41c10f05'
media_key_official='MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzIGO+aFMGuO3n7CAX1mv94DpqLKL3fnHFwOvj/wV3DCoQ5puu/6jsspCnNB7H+tqOzNEZoiWTPcPI+ljfZHvClZUwtQmFIf9ubsLAav9UvXtwq7CBaeEmw9mrCXZ5DSkPopcx18R32hHxffZ/a1F7w9r9T+Me7czGeaii/7n4G6X1dK31TyM8tJjjt5UBN/SfMOcdjHJpS62MvecsQi1DQ4Ta9Y50ZtPBeXIQGgKAkG4b9cCwsRLLxluMG6sLcQAZvHqHkNJaxukyF/t/Wg3QGTxOaVjDd4MhKDp27f5U1Yv5AD/ArzGqt/aY/1XLkc9qD4ivyHBQh/vs8NwfVqXYwIDAQAB'
platform_cert_official='308203b33082029ba003020102020900d94a816d624a0050300d06092a864886f70d01010505003070310b30090603550406130255533113301106035504080c0a57617368696e67746f6e3110300e06035504070c0753656174746c6531123010060355040a0c094c696e656167654f5331123010060355040b0c094c696e656167654f533112301006035504030c094c696e656167654f53301e170d3137303130373034323132365a170d3434303532353034323132365a3070310b30090603550406130255533113301106035504080c0a57617368696e67746f6e3110300e06035504070c0753656174746c6531123010060355040a0c094c696e656167654f5331123010060355040b0c094c696e656167654f533112301006035504030c094c696e656167654f5330820122300d06092a864886f70d01010105000382010f003082010a02820101009a41d7715c8ce053804b1260bbad6c332def57bfd3d26b26102d8892ce9a3d0b780b3bf4cfc5778303470110cde8f6be1766147128731ec202977b62f1b4ae9b0e331a334a27c84c31b5885c4bd4650423cae821c7e08522515f63a9d3667f8c8b33cc9c322704e4645e37b13a50a8d04d3b04dcd0e1a87efbc32e7172f296df8ea33fcb071f9868d91a462e894fe49670ae27354dbfd14a83a23e6c775ae40761c91e416b042ceff81cf66d9e4d73c4bce7e14d6347dcbeab38820316be81decda9a7d5de8da71f1fe0e64a570da004279a6ea2628de4a839a7fdd9baa2d1c5445c6a6e7ed1949a18cd5a23cf602d7dd3d8cf17c953aa525454f17eaef84ea50203010001a350304e301d0603551d0e04160414609957d0ee9881d4d84690e80386c723b738d223301f0603551d23041830168014609957d0ee9881d4d84690e80386c723b738d223300c0603551d13040530030101ff300d06092a864886f70d0101050500038201010063e903bdcb6ee9c7767a170080caccea08a96d7f732fecdd261acdab1f651c701593051408ef0aec2de88fd7e8e7502815cc04a8b47ce35fba0179d0a3f0e7c7e0fc94cce049c34f3601e525b1b92ab19a2618749da33921b090321cff9f146eab1abd9166021a022f003e1034d0c7ba2e3937cfcd75700575fc9d542643924b4d869716eec2c226b1947bc11fe3cd45e3ba27bd52724e30fb69174d6d87199baa425642ab5b2da659ed9da32809311cbc217d1a72f60e8257a191083f210a909507fa08ce8a467b0434fee41a9c068ad0ada084ca87290f0c70b7f16e0d22a31a5dda2a0de059e63257126191a55523d714096582028e99b089b213e71467b2'
platform_key_official='MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmkHXcVyM4FOASxJgu61sMy3vV7/T0msmEC2Iks6aPQt4Czv0z8V3gwNHARDN6Pa+F2YUcShzHsICl3ti8bSumw4zGjNKJ8hMMbWIXEvUZQQjyughx+CFIlFfY6nTZn+MizPMnDInBORkXjexOlCo0E07BNzQ4ah++8MucXLylt+Ooz/LBx+YaNkaRi6JT+SWcK4nNU2/0UqDoj5sd1rkB2HJHkFrBCzv+Bz2bZ5Nc8S85+FNY0fcvqs4ggMWvoHezamn1d6Npx8f4OZKVw2gBCeabqJijeSoOaf92bqi0cVEXGpuftGUmhjNWiPPYC1909jPF8lTqlJUVPF+rvhOpQIDAQAB'
shared_cert_official='308203b33082029ba003020102020900dacb4739a1727e6e300d06092a864886f70d01010505003070310b30090603550406130255533113301106035504080c0a57617368696e67746f6e3110300e06035504070c0753656174746c6531123010060355040a0c094c696e656167654f5331123010060355040b0c094c696e656167654f533112301006035504030c094c696e656167654f53301e170d3137303130373034323132375a170d3434303532353034323132375a3070310b30090603550406130255533113301106035504080c0a57617368696e67746f6e3110300e06035504070c0753656174746c6531123010060355040a0c094c696e656167654f5331123010060355040b0c094c696e656167654f533112301006035504030c094c696e656167654f5330820122300d06092a864886f70d01010105000382010f003082010a028201010096f2f8f3dad19ee79f28256693ce970bda272f72025b4c4a6c20e027a921622530e1b780f9117c98f10b910259005a27da5020d9345844acec3da13ee0d684e067958a23dfc751ec497f5e3f3b13023c5428edc53aadbc44c10bfa84abd436bf13f8222ebf724f7e2e557e81effe21faa52b88899108cd62b7d5a84821576ed2edf50b83324a93439185b078711974395763265f7465b6bb908b0139489707cd4e76e4937545751f6b9c90d7b4bd17a234613d0919ca66e34d78906d5eaa43409e7c57d74266996f2e3f1d5a6061b65fb19f85c62829a8b3978541e64b3fa4f9febcbf5b291eaa433774c45749f73e12d377b9f9b0dfd0d7d8003a78c144a2f50203010001a350304e301d0603551d0e04160414b4dc1c6737cee40f786a398c8bb345d8a8eecbc2301f0603551d23041830168014b4dc1c6737cee40f786a398c8bb345d8a8eecbc2300c0603551d13040530030101ff300d06092a864886f70d010105050003820101002002b4557df909ace023d050f6c739b57ef311ce39abffda1b74161a71554ab78fd23b2b4b57d8c31e646f71f9063e1486a0502da00cfe4d87c4a75dd1eec6416b4460adace72a1cde79ea39f95e4fa3eb1777b9c2f080438298b963d21b54aa3aa7fc6f1b9717333c7b5244ac7862f07c34f443a72462141742f309f51e349fe21b21affcb5369c8723eef2ad2f1452b6bce685337a2751d3bd33eabece08bd62ed6801e6e331eaba7ae0a6dfb632a4fe184141013869bbdbd0d564a44091349890e178f755d14d08d6d868e4abdaa27759fcd576b1f2026db630d11639fd9672d54f0c15b03dc754c5c11ff168d3dd6b2dc7b58e7f47f472f684c41c87bd9e'
shared_key_official='MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAlvL489rRnuefKCVmk86XC9onL3ICW0xKbCDgJ6khYiUw4beA+RF8mPELkQJZAFon2lAg2TRYRKzsPaE+4NaE4GeViiPfx1HsSX9ePzsTAjxUKO3FOq28RMEL+oSr1Da/E/giLr9yT34uVX6B7/4h+qUriImRCM1it9WoSCFXbtLt9QuDMkqTQ5GFsHhxGXQ5V2MmX3RltruQiwE5SJcHzU525JN1RXUfa5yQ17S9F6I0YT0JGcpm4014kG1eqkNAnnxX10JmmW8uPx1aYGG2X7GfhcYoKaizl4VB5ks/pPn+vL9bKR6qQzd0xFdJ9z4S03e5+bDf0NfYADp4wUSi9QIDAQAB'
official_cert='308203b33082029ba003020102020900e10413c773c3c54f300d06092a864886f70d01010505003070310b30090603550406130255533113301106035504080c0a57617368696e67746f6e3110300e06035504070c0753656174746c6531123010060355040a0c094c696e656167654f5331123010060355040b0c094c696e656167654f533112301006035504030c094c696e656167654f53301e170d3137303130373034323132355a170d3434303532353034323132355a3070310b30090603550406130255533113301106035504080c0a57617368696e67746f6e3110300e06035504070c0753656174746c6531123010060355040a0c094c696e656167654f5331123010060355040b0c094c696e656167654f533112301006035504030c094c696e656167654f5330820122300d06092a864886f70d01010105000382010f003082010a0282010100a64dd3e1f842038ff03f67b8e9bf09530fc2913cb53e3654c78ec20dbc8b1e7113628ca5abc0860560cb442c1b51f98b6dce5e59c49037f27f64f48aef0490ab99106f0807a2130e1a8b3aacd834e656f0854b602677b66c007b14c2d0c28d0dc61341de648d879db59a9e79e12888731a3bb1c61fb58f725ac071de12b61093decc5685ac2474cee2cf22f0e44bf208410d91c5d1f60aa7945548822bad756a70e0fe17c83f35e5fa59be4dd2b446048f9b42332186ff0aa47ed39c210de9fd981c55719ec8f30caac4415c21605f13f57d0ecdf0682c484e9456748debe80e2f2e0b1cf47fb95d92fff4673e16f63781f3b2c7cd4b904041abeb5df85059990203010001a350304e301d0603551d0e0416041472963227d66c4c4d5fa0916ac22c793cd45f435c301f0603551d2304183016801472963227d66c4c4d5fa0916ac22c793cd45f435c300c0603551d13040530030101ff300d06092a864886f70d010105050003820101008a247e01c9c72e7167dec24993f23f539c07618c2819ee4d3eae96d283173aebe112469405c4c48052ef1ec72f2949ac0677b49eac5055bea2fe75a8dd3dfc8b3ccf88fb10c4a0c2779dc2861e80b445128c18485ce2b4b4f74ff0389247659b5386572374d0f9bf26ccc261e783397ca3808d5a19de26f8db84d92ac6872b0bdbc60ac768e4ac74d142e7f2c5d5c1cabbca5d1baadb923252b19ba0950370d556707c37c399c936a67e08fd1748cea5656d8add7fa2177ed630796d8de0fae9570b274a04590984d5c065fe307a5346eb54962e41f580d1a448463112e2d5f491a39bb9f9a2a0cac5855c28a35fbdb1ad4a6aeab2aea2f9056e73fc487737eb'
official_key='MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEApk3T4fhCA4/wP2e46b8JUw/CkTy1PjZUx47CDbyLHnETYoylq8CGBWDLRCwbUfmLbc5eWcSQN/J/ZPSK7wSQq5kQbwgHohMOGos6rNg05lbwhUtgJne2bAB7FMLQwo0NxhNB3mSNh521mp554SiIcxo7scYftY9yWsBx3hK2EJPezFaFrCR0zuLPIvDkS/IIQQ2RxdH2CqeUVUiCK611anDg/hfIPzXl+lm+TdK0RgSPm0IzIYb/CqR+05whDen9mBxVcZ7I8wyqxEFcIWBfE/V9Ds3waCxITpRWdI3r6A4vLgsc9H+5XZL/9Gc+FvY3gfOyx81LkEBBq+td+FBZmQIDAQAB'

# microG keys
media_cert_microg="3082034e30820236a003020102020900e01e34ce9affc701300d06092a864886f70d01010b0500303c3118301606035504030c0f6d6963726f672d6b6974746368656e3120301e06092a864886f70d0109011611616e64726f6964406d6963726f672e6d65301e170d3137303930363134313730325a170d3435303132323134313730325a303c3118301606035504030c0f6d6963726f672d6b6974746368656e3120301e06092a864886f70d0109011611616e64726f6964406d6963726f672e6d6530820122300d06092a864886f70d01010105000382010f003082010a0282010100ad4687165b38377cbe3a68f1a2637891f6db99f63fbdeb63e87041b343a3c0a0bc9459845419ae7060f89dddadf0aaa578635ec51f0706d90be84a6800b231a91f24c454f1c2a59ba1fa8bf82207385faf372c51d000134a68e07902925b1ff41d66e1321a34cb76953b02d4a8c58325271e8259c0da63968f90a1c273871940fe11fe3a0c7d33f1f7c75f85c0c36c1d3534c3d90f74acde12cc9eb15faf7cfec3cd77bd87ee27496fa16481cc0e7060c62218f211a52a2847d494f653f7bf8121c2a512e55c01b4c8730d98e83e8261da0a2354595f35696995f8c7a0c2fe3f0dedb21d0a0b5f3b4b5f715c0d213ee0e25d65e875cf40aa37d83d6bc4b190af0203010001a3533051301d0603551d0e04160414499c872822e4a5111e5b248f18bddcfcdfd7d31b301f0603551d23041830168014499c872822e4a5111e5b248f18bddcfcdfd7d31b300f0603551d130101ff040530030101ff300d06092a864886f70d01010b050003820101007d84a56aace610ef52336008f3ca08859c770222b1ba0a963efd6f40f61183c3cafd04a6c409c735f6f8235fbc3e1855bc69fdd3ee6ead6a7b92d998dee944a6776f1a334d1c92b963f7fd5a2e6e6db1419448cd0bd103037a0b63029919e64b9e65329e5b6670624bf412e2c96b7d208d4ffd64486e13148a6e447d108b6b2bb4eabf43233add3b7a9caf655a10a339896ba6299cf5066498b38bde67c744c38c37bdb66527529fb468932e538a5086bfeba162909840b7d00ec7a07e50bb5328d430368d5e157e66aa952d5f773ea165d578214f7b9d9970bac407a2f267a6d8a481b609abac2d2b904736526aac7b09b6301e52c1504dfd7d8a6a7ac0fea6"
platform_cert_microg="3082034e30820236a003020102020900c57e3bea4261d108300d06092a864886f70d01010b0500303c3118301606035504030c0f6d6963726f672d6b6974746368656e3120301e06092a864886f70d0109011611616e64726f6964406d6963726f672e6d65301e170d3137303930363134313434345a170d3435303132323134313434345a303c3118301606035504030c0f6d6963726f672d6b6974746368656e3120301e06092a864886f70d0109011611616e64726f6964406d6963726f672e6d6530820122300d06092a864886f70d01010105000382010f003082010a0282010100b8216beb6bb82f06fb336c85ec4d054e5643c7ee099305ef978443cc6402af4b8334743f88fb23451b7385e95ece5199bcb379ee672d3ec0ff590b09fd3e04282afb9c1b1eb03adda38e873186a566be0f789ee820565e54fbb8e0f7a3127c87aaa4c0909a4216316a8df3fbbd73ccfe8a312fbfe9bdb320bbd482396945d3f7c62937f3ee076e4adef203942f8f6467ee71486bb5df0aafcd21605b93822e0a0a797f5f3c64aba8a04aed815b09ff23dd077e153013b23e20cb90b30cae3bcdbb220f31e24d6157848875c9f6dfabfe62cda172239a759150356cf4732514b10cf2c45dba982b5a3bdb46f51c1b1b09e19648050e48c545dc405268813bad2b0203010001a3533051301d0603551d0e041604146be983c09440088e8fa8eb9053ddcc6815bfc4b2301f0603551d230418301680146be983c09440088e8fa8eb9053ddcc6815bfc4b2300f0603551d130101ff040530030101ff300d06092a864886f70d01010b05000382010100881fef16187df9215233fe7fa5fbdfb323d508e038428372b0aef1758a8f44e96f53e279ade504d751cd9e2dacd994f14eb6c78ffe3486f3dab209e59ee7c62ba02b3aeb3732c38d366feae8868a88f867f3eb83145ce4a456a45be60ff68b89c2354ccee1d48f5e0692c10fa7967fef7228cd53741cb4fa692be4b5b0cbea8fe2deeadc79df32f9e1cca72012bb6374d073825c168c1af18db29f49408d75909a35091da3650884c1f08c922343f76c035546657bb06834757c2ba202651ed95b886d2d86df3f3f80306b26f2b975e32cb0d85ae547e1191fa551571b37412db3a411ea07f3c0dd680344185a8ddc8fce03665d531ac5a45e83096cb615cc0a"
shared_cert_microg="3082034e30820236a0030201020209009708d93b973e808b300d06092a864886f70d01010b0500303c3118301606035504030c0f6d6963726f672d6b6974746368656e3120301e06092a864886f70d0109011611616e64726f6964406d6963726f672e6d65301e170d3137303930363134313832325a170d3435303132323134313832325a303c3118301606035504030c0f6d6963726f672d6b6974746368656e3120301e06092a864886f70d0109011611616e64726f6964406d6963726f672e6d6530820122300d06092a864886f70d01010105000382010f003082010a0282010100c24922bbcf9a984037dd9b4202e15f4e3766d33c2dcffa07eacd9506182498ecc7dbc88c90191345983bd463db0cce73c9192388952d0fb7610a273972440e9e921ac9eb795ebe3cad7f895b3da5cd9d0ea26a44b7e34058049523971adcbb4772af00e97c8ee5a30261fd6719fb40e8e02874d9c0025fc49b6c788035f5fddae609a27abf85e71131d8dd281dabbdd17fe439e5902b42117b88b67db29e89b479d5d5ec11eedefaf74113c23decfd116bd66d0add98797b9be52630b15c8cea539a9c1385a42854897cf71f2a324696438fca55a77bcd3c631c2413bba7994052a7b58f9a59f92e2d81040ee4a28b357a80073c7fce9526bd51b4702db2504b0203010001a3533051301d0603551d0e04160414b89c540085ee4470002b7b2b76852de1c34bee18301f0603551d23041830168014b89c540085ee4470002b7b2b76852de1c34bee18300f0603551d130101ff040530030101ff300d06092a864886f70d01010b05000382010100621004b2e59fab7abcc37618964e556bc333c7051b3bcc32cbd7e3fb730139f529838cd4990b3e0d73627b5f06c816a0fe6bb8676718955d6089fd0fa77b60f3d8080654a69903e5285fdb169a8097f43a76ced209c5b62c8a1e15bb50d6eb4e3d7605e87928e29d65bc11485051ef154f3cb8c9d5803644752862f6c591e6f8e3b45d492b50e25f0a6bc33aa01d36e9f582feb7c47cd923a6d580efd67f457162a38148cb5a74e1bc9d3f47f7d14ac82ef8d1c09f70dad59cf7678ff35a0e64fdebc22520fc8990959cd2713430590c0cc104cc706e143b399380668db80047417dc28e1404cc62f0f6623a7329129d53c590d571ea73ec51885f257972696b"
microg_cert="3082034e30820236a003020102020900d0d666dd0ed8aa87300d06092a864886f70d01010b0500303c3118301606035504030c0f6d6963726f672d6b6974746368656e3120301e06092a864886f70d0109011611616e64726f6964406d6963726f672e6d65301e170d3137303930363133313534395a170d3435303132323133313534395a303c3118301606035504030c0f6d6963726f672d6b6974746368656e3120301e06092a864886f70d0109011611616e64726f6964406d6963726f672e6d6530820122300d06092a864886f70d01010105000382010f003082010a0282010100c60de8010566c9bb391cf9cfa4d1d0b01e9bac92ff721068e88808f31de4d159962a2c0e17342b48c77577e07e2934d7a8be9618bd870af6abe6dceee39962ddca553d46d6eaa4d4b695a3391cdb051ed16c9bcabc93a2f82a7bdccd390fbd9c7249a0265a378a6be6aad77ddcc59c7c8586a1895f9516d27725d55432fabe45b246f6a575b9c45e5780bcdc70a6fde6045ca828046ef693b07cdf17c733b8d80d9031058b96d9d8dd107276f421739423eb8287445abb91fb6c6dd2363ddd29b8c7b7e905b4df55d5b462e2d1c8a68ed88e0d46c5a9cc9b117e11c91a1a27bddcecf86f3a26463a8551a75904c8a9862670d54930b977bc0f586a315389c87f0203010001a3533051301d0603551d0e04160414125e842abb1679b137c27dfb5961562127490f8e301f0603551d23041830168014125e842abb1679b137c27dfb5961562127490f8e300f0603551d130101ff040530030101ff300d06092a864886f70d01010b0500038201010061651c848a9a833b125d534956bf434f0c422b7bd7340179b263370585ac4a70e11ec56fa8c8691fa59bf7e2374789ebc487e6e0e341ae29f6627d34ee02f975777621a107b1e5115da0b6db3147cd69c1e3cb752b19a225a39f996165bc27845e1c3898b696dc8ba3fa218616ef2136aa352d959613039155b1b81f69f27e931afb0e9105f9d61b0a601601b9044e159da96b0e2c5a21f675653d47bb6ebaf32e08b18656729681b7e00501b4cd8b241b1ee8515a702dc8f8f24d1c35248ab3d75ea798668c50f6100f1304c50298466a64975f1b9afb9a1d60f1b794146c80fb2c79f1f6f53fce9fc91f3c2181081426b0fa4d7ee59c45cf23700eec547238"
media_key_microg="MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArUaHFls4N3y+OmjxomN4kfbbmfY/vetj6HBBs0OjwKC8lFmEVBmucGD4nd2t8KqleGNexR8HBtkL6EpoALIxqR8kxFTxwqWbofqL+CIHOF+vNyxR0AATSmjgeQKSWx/0HWbhMho0y3aVOwLUqMWDJSceglnA2mOWj5ChwnOHGUD+Ef46DH0z8ffHX4XAw2wdNTTD2Q90rN4SzJ6xX698/sPNd72H7idJb6FkgcwOcGDGIhjyEaUqKEfUlPZT97+BIcKlEuVcAbTIcw2Y6D6CYdoKI1RZXzVpaZX4x6DC/j8N7bIdCgtfO0tfcVwNIT7g4l1l6HXPQKo32D1rxLGQrwIDAQAB"
platform_key_microg="MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuCFr62u4Lwb7M2yF7E0FTlZDx+4JkwXvl4RDzGQCr0uDNHQ/iPsjRRtzhelezlGZvLN57mctPsD/WQsJ/T4EKCr7nBsesDrdo46HMYalZr4PeJ7oIFZeVPu44PejEnyHqqTAkJpCFjFqjfP7vXPM/ooxL7/pvbMgu9SCOWlF0/fGKTfz7gduSt7yA5Qvj2Rn7nFIa7XfCq/NIWBbk4IuCgp5f188ZKuooErtgVsJ/yPdB34VMBOyPiDLkLMMrjvNuyIPMeJNYVeEiHXJ9t+r/mLNoXIjmnWRUDVs9HMlFLEM8sRdupgrWjvbRvUcGxsJ4ZZIBQ5IxUXcQFJogTutKwIDAQAB"
shared_key_microg="MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAwkkiu8+amEA33ZtCAuFfTjdm0zwtz/oH6s2VBhgkmOzH28iMkBkTRZg71GPbDM5zyRkjiJUtD7dhCic5ckQOnpIayet5Xr48rX+JWz2lzZ0OompEt+NAWASVI5ca3LtHcq8A6XyO5aMCYf1nGftA6OAodNnAAl/Em2x4gDX1/drmCaJ6v4XnETHY3Sgdq73Rf+Q55ZArQhF7iLZ9sp6JtHnV1ewR7t7690ETwj3s/RFr1m0K3Zh5e5vlJjCxXIzqU5qcE4WkKFSJfPcfKjJGlkOPylWne808YxwkE7unmUBSp7WPmln5Li2BBA7koos1eoAHPH/OlSa9UbRwLbJQSwIDAQAB"
microg_key="MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxg3oAQVmybs5HPnPpNHQsB6brJL/chBo6IgI8x3k0VmWKiwOFzQrSMd1d+B+KTTXqL6WGL2HCvar5tzu45li3cpVPUbW6qTUtpWjORzbBR7RbJvKvJOi+Cp73M05D72cckmgJlo3imvmqtd93MWcfIWGoYlflRbSdyXVVDL6vkWyRvaldbnEXleAvNxwpv3mBFyoKARu9pOwfN8XxzO42A2QMQWLltnY3RBydvQhc5Qj64KHRFq7kftsbdI2Pd0puMe36QW031XVtGLi0cimjtiODUbFqcybEX4RyRoaJ73c7PhvOiZGOoVRp1kEyKmGJnDVSTC5d7wPWGoxU4nIfwIDAQAB"


#los-legacy.de microg keys

loslegacy_cert='3082040b308202f3a003020102021417814a15b269f26941e2962c4a167c22054b1df2300d06092a864886f70d01010b0500308194310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643110300e06035504030c07416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3232303432353030303231345a170d3439303931303030303231345a308194310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643110300e06035504030c07416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820122300d06092a864886f70d01010105000382010f003082010a0282010100c4e8d7d5d39f1300c8c38ce38641c7db4e88e94ca02aa025a67879fe4b98f886f90833b3c0bd576e1018ee72bde67916d744213538b2b94ef31330c33ff2c288919e6a96e8e3c2e8774731630c739c92491d8216f5301b933e1c99930b4c931a08661cba044a714620eb02bdc10a918cded4ad61126ccc8b672e4146618ddbf8b3edd1b67051e4491d0a3c504f0c8b1027ef6a5d1a613418c5df44932ade734c1821693989954681c40fa06f06de3b5ae856eade6b779d680dbda601cbef649c3d77b1c4639bc6ca1fac8f3abd90518117c501c49c90f6f4fa01718c9cf42d354516d9fc8463d3a3108d4374c9e845ab50b5556c0f2304492a04f4f636308fa50203010001a3533051301d0603551d0e04160414a5d3fef87a515876299f8c0bf275a350159aa021301f0603551d23041830168014a5d3fef87a515876299f8c0bf275a350159aa021300f0603551d130101ff040530030101ff300d06092a864886f70d01010b0500038201010033959cb65c5d6a6894ba2d0d2eb7b4893fe1dbe9ed6c43797d7541ea1d2ed7cd1dec4bebff3b2d4f27c005e9cfd6ecf46a38c7769c0943ebdf6414059ef850631417d445b855f5db6b9cc25c61610e9cc164bb84e7e19b6447208f86aa571d38429bc898f34f2828c79fc4bb9971295e80712bc0ad378c47b87614c3425c9a41cb73f6e25b9d80035d4d5069f2566dc46851437912d89f9cb89d09e45ec49f734ce9f8a2fd937ec4cc9d87bfaf74aa279c08e1c3a19bf0eebf32a5f132b84e459756721010e42a0d56d8bb5456e87567152fa9d0322b18ef908b44aeda25476e3483233b2820b941c24a9d334d46603d07560cd661f46f81ac1068a4ec25a537'
loslegacy_key='MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxOjX1dOfEwDIw4zjhkHH206I6UygKqAlpnh5/kuY+Ib5CDOzwL1XbhAY7nK95nkW10QhNTiyuU7zEzDDP/LCiJGeapbo48Lod0cxYwxznJJJHYIW9TAbkz4cmZMLTJMaCGYcugRKcUYg6wK9wQqRjN7UrWESbMyLZy5BRmGN2/iz7dG2cFHkSR0KPFBPDIsQJ+9qXRphNBjF30STKt5zTBghaTmJlUaBxA+gbwbeO1roVurea3edaA29pgHL72ScPXexxGObxsofrI86vZBRgRfFAcSckPb0+gFxjJz0LTVFFtn8hGPToxCNQ3TJ6EWrULVVbA8jBEkqBPT2NjCPpQIDAQAB'
platform_key_loslegacy='MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAyDvY3dfzrkhy897dbRyepYdPGNXxP3mReFBjxWyfB/laP6/72Iv1szZAq9qpNAJgrqn7VrFLFgoCWXg2FdJNPDmuaYbTofNWS9jcZXthJ+GLNdzXKC02KyxtF3N7Bc/+VkYxVE3pf9n6Oa4vxJIlckR3zVJf8HY7XvRWmbN28A3BWahnSV7AT89EodGjOx1PF4WNY8XzS2nS6vv2aYUgcFtAR2Ap140XIX5afp8VHDyNUCC4Jm/Euu4/e90miQliEEODlVsuxe/HLAsplWVOOZjyHYMZ/Rlsh9IyFrbvDMUbrZOLMEGQkuRRQV+zAY0+0XLgW0hdEy20CtVGFzujBQIDAQAB'
platform_cert_loslegacy='3082040b308202f3a00302010202143ec57040584e0fcbac20a628ac61a2df06a1a6ec300d06092a864886f70d01010b0500308194310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643110300e06035504030c07416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3232303432353030303231345a170d3439303931303030303231345a308194310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643110300e06035504030c07416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820122300d06092a864886f70d01010105000382010f003082010a0282010100c83bd8ddd7f3ae4872f3dedd6d1c9ea5874f18d5f13f7991785063c56c9f07f95a3faffbd88bf5b33640abdaa9340260aea9fb56b14b160a0259783615d24d3c39ae6986d3a1f3564bd8dc657b6127e18b35dcd7282d362b2c6d17737b05cffe564631544de97fd9fa39ae2fc49225724477cd525ff0763b5ef45699b376f00dc159a867495ec04fcf44a1d1a33b1d4f17858d63c5f34b69d2eafbf6698520705b40476029d78d17217e5a7e9f151c3c8d5020b8266fc4baee3f7bdd26890962104383955b2ec5efc72c0b2995654e3998f21d8319fd196c87d23216b6ef0cc51bad938b30419092e451415fb3018d3ed172e05b485d132db40ad546173ba3050203010001a3533051301d0603551d0e04160414310f3f8e9494d7848f5bcadec5d8221d96ca3f17301f0603551d23041830168014310f3f8e9494d7848f5bcadec5d8221d96ca3f17300f0603551d130101ff040530030101ff300d06092a864886f70d01010b050003820101001bc5661db9e0a03667d6b89159be45a5fac20ae7786b5db520b246f865d0278696e5e425ad4dd8c4ea4cfda196c227aeb89cc9449be5d12a4abab655a195da46ffd623d4dc6c490402d2d612024411cc7869a27a9a2c231895081dcdbba6c4ccc4811250f456fafdca22f7dbe5f77282c0647fb0b759eeca6e2a0dca967c458c97111eb1ad43ddaaa67b25ff2c114328ba09825318fdc874e7cb8921b297feeb56f7cd1c44ba731eeb15d155cba74b14a4f05ca959828e653c476cbe47a5ababcf5685ea485db7911993e5b9946ab5788c0b639f068de444d217f6fe07e88567b3f9586437f8f6f4d080f88a80874fa8e44402aa16c6041d45edc73b51a6ba86'
media_key_loslegacy='MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA7K6i05i3C6/504u9CTcTfKUsCfATzy02hdfG0uUqR+3eeP9J3UZdDCFzbX0ysWnbIhDqgmhcnJu9iNTqjcuYcSCVt6eGHp+4TmavKe8osp/A9dpxhpQIefJsZs4mW+AVjVaCByNia2NkwEgH1jW/cnv3fJtoOh3GdPfMfONiFVHff3fRssIgjQ2HyWSBgKv6F+YhVn5lYh8yn4+U4FoULuHUD3ToH/i94AnlK0rYtm79bNXdx3fHP/mI61+CIYU5aSHCiNlnyFx82/s3bAke13zIPkGEJ273QHW3SEY9BigL+RK7nIV41Ar0vGqKEgrPjQSwL/EpZ+EutGGKB3z+1QIDAQAB'
media_cert_loslegacy='3082040b308202f3a003020102021473dbb5be9ed279fa7cefea5e294e0796fa7779dd300d06092a864886f70d01010b0500308194310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643110300e06035504030c07416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3232303432353030303231355a170d3439303931303030303231355a308194310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643110300e06035504030c07416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820122300d06092a864886f70d01010105000382010f003082010a0282010100ecaea2d398b70baff9d38bbd0937137ca52c09f013cf2d3685d7c6d2e52a47edde78ff49dd465d0c21736d7d32b169db2210ea82685c9c9bbd88d4ea8dcb98712095b7a7861e9fb84e66af29ef28b29fc0f5da7186940879f26c66ce265be0158d56820723626b6364c04807d635bf727bf77c9b683a1dc674f7cc7ce3621551df7f77d1b2c2208d0d87c9648180abfa17e621567e65621f329f8f94e05a142ee1d40f74e81ff8bde009e52b4ad8b66efd6cd5ddc777c73ff988eb5f822185396921c288d967c85c7cdbfb376c091ed77cc83e4184276ef74075b748463d06280bf912bb9c8578d40af4bc6a8a120acf8d04b02ff12967e12eb4618a077cfed50203010001a3533051301d0603551d0e0416041497dbc880afd25816a284b13536f4e5b474c25826301f0603551d2304183016801497dbc880afd25816a284b13536f4e5b474c25826300f0603551d130101ff040530030101ff300d06092a864886f70d01010b05000382010100b5c7f3b90f6a8f5f1129d628a6529eae72ad7e9fcd2bf235516de17466bc1065e89fec1dc43bd5279d3c16270d9419251e1d160d03d44165912ad3067e9da8a58ec7c73c1006e22950ec87a57336182f1adebef99f20bc8800c085252f9808056ea8d46f57605c03ede11a5051ffe3908c609ab9cf396f5f7a8cf9e49f88231b24511f122689777c4bc230e31d4c9a50fd9507ae7136210e562a358bd5b9732b2f9130d42c27c8aff947ec0bd825a3dec0b724f3381ab1f16c8a7e02b0e044f2da416983398bb16bfd5cff6b08b06d507975eaf5cf7dff5b34b8a9ea1b549808d61b6353e498bae633bab1ecfbd4431f5a92282d015cccdef970ad09eb54ff94'
shared_key_loslegacy='MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3wcRJgoi2ozRHd6xN77PCclH668uq2GdLcMysY+LR08RYG7ercGm/olMwclHZFUoLXiEpKtMRxicgRfE5coYRtn6V/Ah3eVxkEYnq9lqSnWxO19VS479Hh3l/Ghl02kiU7DQ73v228TZQjAIHA/SaZB6T9WbzqafpLleg2bbmCnrY1fyOHjruwK+wTge682eOECQXQy+WnRFGBFsIezOt+/V1x5nKl4ONV4yvKqI/JVfupwlnPfoZ2aslWfbKDIyNtTWykxsSGfHPiEPPym3qhi3hwCfNpJm0Vt4F+jYDrVU6Azn9xKbKoRHRWAyjPNDxHuWzE9tXPWcN8nuwlEaiwIDAQAB'
shared_cert_loslegacy='3082040b308202f3a003020102021476c200bde04d57703d33599706f4b0837dd905f3300d06092a864886f70d01010b0500308194310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643110300e06035504030c07416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3232303432353030303231355a170d3439303931303030303231355a308194310b30090603550406130255533113301106035504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e20566965773110300e060355040a0c07416e64726f69643110300e060355040b0c07416e64726f69643110300e06035504030c07416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820122300d06092a864886f70d01010105000382010f003082010a0282010100df0711260a22da8cd11ddeb137becf09c947ebaf2eab619d2dc332b18f8b474f11606edeadc1a6fe894cc1c9476455282d7884a4ab4c47189c8117c4e5ca1846d9fa57f021dde571904627abd96a4a75b13b5f554b8efd1e1de5fc6865d3692253b0d0ef7bf6dbc4d94230081c0fd269907a4fd59bcea69fa4b95e8366db9829eb6357f23878ebbb02bec1381eebcd9e3840905d0cbe5a744518116c21ecceb7efd5d71e672a5e0e355e32bcaa88fc955fba9c259cf7e86766ac9567db28323236d4d6ca4c6c4867c73e210f3f29b7aa18b787009f369266d15b7817e8d80eb554e80ce7f7129b2a84474560328cf343c47b96cc4f6d5cf59c37c9eec2511a8b0203010001a3533051301d0603551d0e041604141423f9165d40f46c70b1c39ae34a4cd5eb867445301f0603551d230418301680141423f9165d40f46c70b1c39ae34a4cd5eb867445300f0603551d130101ff040530030101ff300d06092a864886f70d01010b05000382010100260d3bb996d56974b1ea1fa94bf7e338b3636feb20acbe995e049d05a06073e4992574ff662e78db13a8493f91cc015b50c5adacf7f70c8193f05b6a7d99b47c2b45fe2f43ab301e977284a471077b17a2ba2ad88adc2b0b11e60071536a026bbe221c83e67b9688c93675b8001d2166eeae5071e6ccc44cda5e46d33d65f8f4ab1448d27059ba6ce688533a0ddd8dda42e0b91fd304b93fd866cc099d3f1d5b19c91adbf5fc7471a170863ed2de493ed09eeb41fc7a0d1e3bf38ed6f600086ea489b1a2f9ccabd4cc452db23788055d335fd716d6eba2e84f3b89a08f9722806246b4bd770a521346351533bd3ba2eeec725a8d1a895b06550eb1dfbdbb2266'

# Test keys
media_cert_test='308204a830820390a003020102020900f2b98e6123572c4e300d06092a864886f70d0101040500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303431353233343035375a170d3335303930313233343035375a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d00308201080282010100ae250c5a16ef97fc2869ac651b3217cc36ba0e86964168d58a049f40ce85867123a3ffb4f6d949c33cf2da3a05c23eacaa57d803889b1759bcf59e7c6f21890ae25085b7ed56aa626c0989ef9ccd36362ca0e8d1b9603fd4d8328767926ccc090c68b775ae7ff30934cc369ef2855a2667df0c667fd0c7cf5d8eba655806737303bb624726eabaedfb72f07ed7a76ab3cb9a381c4b7dcd809b140d891f00213be401f58d6a06a61eadc3a9c2f1c6567285b09ae09342a66fa421eaf93adf7573a028c331d70601ab3af7cc84033ece7c772a3a5b86b0dbe9d777c3a48aa9801edcee2781589f44d9e4113979600576a99410ba81091259dad98c6c68ff784b8f020103a381fc3081f9301d0603551d0e04160414ca293caa8bc0ed3e542eef4205a2bff2b57e4d753081c90603551d230481c13081be8014ca293caa8bc0ed3e542eef4205a2bff2b57e4d75a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900f2b98e6123572c4e300c0603551d13040530030101ff300d06092a864886f70d0101040500038201010084de9516d5e4a87217a73da8487048f53373a5f733f390d61bdf3cc9e5251625bfcaa7c3159cae275d172a9ae1e876d5458127ac542f68290dd510c0029d8f51e0ee156b7b7b5acdb394241b8ec78b74e5c42c5cafae156caf5bd199a23a27524da072debbe378464a533630b0e4d0ffb7e08ecb701fadb6379c74467f6e00c6ed888595380792038756007872c8e3007af423a57a2cab3a282869b64c4b7bd5fc187d0a7e2415965d5aae4e07a6df751b4a75e9793c918a612b81cd0b628aee0168dc44e47b10d3593260849d6adf6d727dc24444c221d3f9ecc368cad07999f2b8105bc1f20d38d41066cc1411c257a96ea4349f5746565507e4e8020a1a81'
media_key_test='MIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKCAQEAriUMWhbvl/woaaxlGzIXzDa6DoaWQWjVigSfQM6FhnEjo/+09tlJwzzy2joFwj6sqlfYA4ibF1m89Z58byGJCuJQhbftVqpibAmJ75zNNjYsoOjRuWA/1Ngyh2eSbMwJDGi3da5/8wk0zDae8oVaJmffDGZ/0MfPXY66ZVgGc3MDu2JHJuq67fty8H7Xp2qzy5o4HEt9zYCbFA2JHwAhO+QB9Y1qBqYercOpwvHGVnKFsJrgk0Kmb6Qh6vk633VzoCjDMdcGAas698yEAz7OfHcqOluGsNvp13fDpIqpgB7c7ieBWJ9E2eQROXlgBXaplBC6gQkSWdrZjGxo/3hLjwIBAw=='
platform_cert_test='308204a830820390a003020102020900b3998086d056cffa300d06092a864886f70d0101040500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303431353232343035305a170d3335303930313232343035305a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d003082010802820101009c780592ac0d5d381cdeaa65ecc8a6006e36480c6d7207b12011be50863aabe2b55d009adf7146d6f2202280c7cd4d7bdb26243b8a806c26b34b137523a49268224904dc01493e7c0acf1a05c874f69b037b60309d9074d24280e16bad2a8734361951eaf72a482d09b204b1875e12ac98c1aa773d6800b9eafde56d58bed8e8da16f9a360099c37a834a6dfedb7b6b44a049e07a269fccf2c5496f2cf36d64df90a3b8d8f34a3baab4cf53371ab27719b3ba58754ad0c53fc14e1db45d51e234fbbe93c9ba4edf9ce54261350ec535607bf69a2ff4aa07db5f7ea200d09a6c1b49e21402f89ed1190893aab5a9180f152e82f85a45753cf5fc19071c5eec827020103a381fc3081f9301d0603551d0e041604144fe4a0b3dd9cba29f71d7287c4e7c38f2086c2993081c90603551d230481c13081be80144fe4a0b3dd9cba29f71d7287c4e7c38f2086c299a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900b3998086d056cffa300c0603551d13040530030101ff300d06092a864886f70d01010405000382010100572551b8d93a1f73de0f6d469f86dad6701400293c88a0cd7cd778b73dafcc197fab76e6212e56c1c761cfc42fd733de52c50ae08814cefc0a3b5a1a4346054d829f1d82b42b2048bf88b5d14929ef85f60edd12d72d55657e22e3e85d04c831d613d19938bb8982247fa321256ba12d1d6a8f92ea1db1c373317ba0c037f0d1aff645aef224979fba6e7a14bc025c71b98138cef3ddfc059617cf24845cf7b40d6382f7275ed738495ab6e5931b9421765c491b72fb68e080dbdb58c2029d347c8b328ce43ef6a8b15533edfbe989bd6a48dd4b202eda94c6ab8dd5b8399203daae2ed446232e4fe9bd961394c6300e5138e3cfd285e6e4e483538cb8b1b357'
platform_key_test='MIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKCAQEAnHgFkqwNXTgc3qpl7MimAG42SAxtcgexIBG+UIY6q+K1XQCa33FG1vIgIoDHzU172yYkO4qAbCazSxN1I6SSaCJJBNwBST58Cs8aBch09psDe2AwnZB00kKA4WutKoc0NhlR6vcqSC0JsgSxh14SrJjBqnc9aAC56v3lbVi+2OjaFvmjYAmcN6g0pt/tt7a0SgSeB6Jp/M8sVJbyzzbWTfkKO42PNKO6q0z1M3GrJ3GbO6WHVK0MU/wU4dtF1R4jT7vpPJuk7fnOVCYTUOxTVge/aaL/SqB9tffqIA0JpsG0niFAL4ntEZCJOqtakYDxUugvhaRXU89fwZBxxe7IJwIBAw=='
shared_cert_test='308204a830820390a003020102020900f2a73396bd38767a300d06092a864886f70d0101040500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303732333231353735395a170d3335313230393231353735395a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d00308201080282010100c8c2dbfd094a2df45c3ff1a32ed21805ec72fc58d017971bd0f6b52c262d70819d191967e158dfd3a2c7f1b3e0e80ce545d79d2848220211eb86f0fd8312d37b420c113750cc94618ae872f4886463bdc4627caa0c0483c86493e3515571170338bfdcc4cd6addd1c0a2f35f5cf24ed3e4043a3e58e2b05e664ccde12bcb67735fd6df1249c369e62542bc0a4729e53917f5c38ffa52d17b73c9c73798ddb18ed481590875547e66bfc5daca4c25a6eb960ed96923709da302ba646cb496b325e86c5c8b2e7a3377b2bbe4c7cf33254291163f689152ac088550c83c508f4bf5adf0aed5a2dca0583f9ab0ad17650db7eea4b23fdb45885547d0feab72183889020103a381fc3081f9301d0603551d0e04160414cb4c7e2cdbb3f0ada98dab79968d172e9dbb1ed13081c90603551d230481c13081be8014cb4c7e2cdbb3f0ada98dab79968d172e9dbb1ed1a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900f2a73396bd38767a300c0603551d13040530030101ff300d06092a864886f70d0101040500038201010040a8d096997959e917a36c44246b6bac2bae05437ecd89794118f7834720352d1c6f8a39b0869942f4da65981faa2951d33971129ec1921d795671c527d6e249f252829faf5b591310311e2de096500d568ad4114a656dc34a8c6f610453afc1ea7992dba4aa7b3f8543a6e35c0728de77fe97eeac83771fd0ec90f8e4449434ee0b6045783e70c7a2e460249260e003cf7608dc352a4c9ef706def4b26050e978ae2fffd7a3323787014915eb3cc874fcc7a9ae930877c5c8c7d1c2e2a8ee863c89180d1855cedba400e7ba43cccaa7243d397e7c0e8e8e4d7d4f92b6bbead49c0cf018069eddca2e7e2fb4668d89dbbd7950d0cd254180fa1eaafc2a556f84'
shared_key_test='MIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKCAQEAyMLb/QlKLfRcP/GjLtIYBexy/FjQF5cb0Pa1LCYtcIGdGRln4Vjf06LH8bPg6AzlRdedKEgiAhHrhvD9gxLTe0IMETdQzJRhiuhy9IhkY73EYnyqDASDyGST41FVcRcDOL/cxM1q3dHAovNfXPJO0+QEOj5Y4rBeZkzN4SvLZ3Nf1t8SScNp5iVCvApHKeU5F/XDj/pS0Xtzycc3mN2xjtSBWQh1VH5mv8XaykwlpuuWDtlpI3CdowK6ZGy0lrMl6Gxciy56M3eyu+THzzMlQpEWP2iRUqwIhVDIPFCPS/Wt8K7VotygWD+asK0XZQ237qSyP9tFiFVH0P6rchg4iQIBAw=='
test_cert='308204a830820390a003020102020900936eacbe07f201df300d06092a864886f70d0101050500308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d301e170d3038303232393031333334365a170d3335303731373031333334365a308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d30820120300d06092a864886f70d01010105000382010d00308201080282010100d6931904dec60b24b1edc762e0d9d8253e3ecd6ceb1de2ff068ca8e8bca8cd6bd3786ea70aa76ce60ebb0f993559ffd93e77a943e7e83d4b64b8e4fea2d3e656f1e267a81bbfb230b578c20443be4c7218b846f5211586f038a14e89c2be387f8ebecf8fcac3da1ee330c9ea93d0a7c3dc4af350220d50080732e0809717ee6a053359e6a694ec2cb3f284a0a466c87a94d83b31093a67372e2f6412c06e6d42f15818dffe0381cc0cd444da6cddc3b82458194801b32564134fbfde98c9287748dbf5676a540d8154c8bbca07b9e247553311c46b9af76fdeeccc8e69e7c8a2d08e782620943f99727d3c04fe72991d99df9bae38a0b2177fa31d5b6afee91f020103a381fc3081f9301d0603551d0e04160414485900563d272c46ae118605a47419ac09ca8c113081c90603551d230481c13081be8014485900563d272c46ae118605a47419ac09ca8c11a1819aa48197308194310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630140603550407130d4d6f756e7461696e20566965773110300e060355040a1307416e64726f69643110300e060355040b1307416e64726f69643110300e06035504031307416e64726f69643122302006092a864886f70d0109011613616e64726f696440616e64726f69642e636f6d820900936eacbe07f201df300c0603551d13040530030101ff300d06092a864886f70d010105050003820101007aaf968ceb50c441055118d0daabaf015b8a765a27a715a2c2b44f221415ffdace03095abfa42df70708726c2069e5c36eddae0400be29452c084bc27eb6a17eac9dbe182c204eb15311f455d824b656dbe4dc2240912d7586fe88951d01a8feb5ae5a4260535df83431052422468c36e22c2a5ef994d61dd7306ae4c9f6951ba3c12f1d1914ddc61f1a62da2df827f603fea5603b2c540dbd7c019c36bab29a4271c117df523cdbc5f3817a49e0efa60cbd7f74177e7a4f193d43f4220772666e4c4d83e1bd5a86087cf34f2dec21e245ca6c2bb016e683638050d2c430eea7c26a1c49d3760a58ab7f1a82cc938b4831384324bd0401fa12163a50570e684d'
test_key='MIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKCAQEA1pMZBN7GCySx7cdi4NnYJT4+zWzrHeL/Boyo6LyozWvTeG6nCqds5g67D5k1Wf/ZPnepQ+foPUtkuOT+otPmVvHiZ6gbv7IwtXjCBEO+THIYuEb1IRWG8DihTonCvjh/jr7Pj8rD2h7jMMnqk9Cnw9xK81AiDVAIBzLggJcX7moFM1nmppTsLLPyhKCkZsh6lNg7MQk6ZzcuL2QSwG5tQvFYGN/+A4HMDNRE2mzdw7gkWBlIAbMlZBNPv96YySh3SNv1Z2pUDYFUyLvKB7niR1UzEcRrmvdv3uzMjmnnyKLQjngmIJQ/mXJ9PAT+cpkdmd+brjigshd/ox1bav7pHwIBAw=='


PACKAGES=/data/system/packages.xml
PACKAGES_BACKUP=/data/system/packages-backup.xml

if [ -z ${1+x} ] || [ -z ${2+x} ]; then
	echo "USAGE: $0 ORIG_KEYS NEW_KEYS"
	echo "Available keys: official, microg, test"
	echo "You can also source own keys piped from export-keys.sh or similar"
	echo "To use keys generated by export-keys.sh use \"release\" keys"
	echo "Example usage:"
	echo "  $0 official microg"
	echo "    official to microg migration"
	echo "  ./export-keys.sh > keys.sh ; source keys.sh ; $0 official release"
	echo "    official to own release migration"
	echo "  $0 microg test"
	echo "    microG to unofficial \"unsigned\" build migration"
	echo "More information: https://wiki.lineageos.org/signing_builds.html#using-a-script"
	
	exit 1
fi

for x in media_cert media_key platform_cert platform_key shared_cert shared_key; do
	eval "${x}_orig=\"\$${x}_$1\""
	eval "${x}_new=\"\$${x}_$2\""
done;

eval "orig_cert=\"\$${1}_cert\""
eval "orig_key=\"\$${1}_key\""
eval "new_cert=\"\$${2}_cert\""
eval "new_key=\"\$${2}_key\""

echo "Migrating $1 to $2"

# If there's a "backup" copy, then the current packages.xml might
# be corrupted, so overwrite it with the backup copy. This is what
# PackageManager would do.
if [ -f $PACKAGES_BACKUP ]; then
    mv $PACKAGES_BACKUP $PACKAGES
    echo "Overwriting $PACKAGES with $PACKAGES_BACKUP"
fi

if [ ! -f $PACKAGES ]; then
    echo "Error: $PACKAGES not found"
    exit 1
fi

# Save a copy of the current file, not to be confused with
# packages-backup.xml, which is used and generated by Android
echo "Saving backup as $PACKAGES.bak"
cp $PACKAGES $PACKAGES.bak

sed -i "s#$media_cert_orig#$media_cert_new#g" $PACKAGES
sed -i "s#$platform_cert_orig#$platform_cert_new#g" $PACKAGES
sed -i "s#$shared_cert_orig#$shared_cert_new#g" $PACKAGES
sed -i "s#$orig_cert#$new_cert#g" $PACKAGES
sed -i "s#$media_key_orig#$media_key_new#g" $PACKAGES
sed -i "s#$platform_key_orig#$platform_key_new#g" $PACKAGES
sed -i "s#$shared_key_orig#$shared_key_new#g" $PACKAGES
sed -i "s#$orig_key#$new_key#g" $PACKAGES

chmod 660 $PACKAGES
chown system:system $PACKAGES

echo "Done"
